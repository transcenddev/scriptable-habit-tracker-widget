// Pretty Progress Habit Streak Widget for Scriptable
// Customization Inputs
const habitName = "Meditation"; // ← Edit your habit name here
const streakCount = 57;         // ← Edit your streak count here (max 100)

// Appearance Settings
const filledDotColor = Color.white();
const emptyDotColor = new Color("#444444");
const bgColor = new Color("#18181b");
const gridRows = 10;
const gridCols = 10;
const dotSizeSmall = 10;
const dotSizeMedium = 14;
const dotSpacing = 6;
const cornerRadius = 18;

// Determine widget size and adjust dot size
let dotSize = dotSizeSmall;
if (config.widgetFamily === "medium") dotSize = dotSizeMedium;

// Create widget
let w = new ListWidget();
w.backgroundColor = bgColor;
w.cornerRadius = cornerRadius;
w.setPadding(18, 18, 18, 18);

// Centered grid stack
let gridStack = w.addStack();
gridStack.layoutVertically();
gridStack.centerAlignContent();

// Build the 10x10 grid
let dotIndex = 0;
for (let row = 0; row < gridRows; row++) {
  let rowStack = gridStack.addStack();
  rowStack.layoutHorizontally();
  rowStack.centerAlignContent();
  for (let col = 0; col < gridCols; col++) {
    let dot = rowStack.addText("●");
    dot.font = Font.systemFont(dotSize);
    dot.textColor = (dotIndex < streakCount) ? filledDotColor : emptyDotColor;
    dotIndex++;
    if (col < gridCols - 1) rowStack.addSpacer(dotSpacing);
  }
  if (row < gridRows - 1) gridStack.addSpacer(dotSpacing);
}

// Spacer between grid and bottom text
w.addSpacer(16);

// Bottom row: habit name (left), streak count (right)
let bottomStack = w.addStack();
bottomStack.layoutHorizontally();

// Habit name (left)
let nameText = bottomStack.addText(habitName);
nameText.font = Font.mediumSystemFont(13);
nameText.textColor = Color.white();
nameText.lineLimit = 1;

// Spacer
bottomStack.addSpacer();

// Streak count (right)
let streakText = bottomStack.addText(`${streakCount} day${streakCount === 1 ? "" : "s"}`);
streakText.font = Font.mediumSystemFont(13);
streakText.textColor = Color.white();
streakText.lineLimit = 1;

// Show widget
if (config.runsInWidget) {
  Script.setWidget(w);
} else {
  await w.presentMedium();
}
Script.complete();